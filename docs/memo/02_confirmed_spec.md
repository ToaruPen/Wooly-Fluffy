# 02_confirmed_spec

## モード（決定）

### `ROOM`（デフォルト）

- 全体向けの雑談モード
- 個人紐付けの記憶保存はしない
- 会話コンテキストは短期のみ（必要ならRAMで保持、ディスクには残さない）

### `PERSONAL(name)`（MVP / NFCなし）

- Push-to-talk で `「パーソナル、<name>」` と言ったら開始
- `name`（呼び名）はユニーク運用（同名が出たら別の呼び名にしてもらう）
- 終了条件:
  - 無操作 `3分` で `ROOM` に戻る（タイムアウトは明示アナウンスしない）
  - `「ルーム」` 発話で戻る
  - 職員UIの「ROOMへ戻す」で戻る

### `PERSONAL(child)`（将来 / NFC）

- NFC導入で `PERSONAL(name)` を置き換える想定

## 入力UX（決定）

- デフォルトは待機（反応しない）
- Push-to-talk（ボタン押下中だけ認識開始）

## バイオメトリクス（決定）

- 導入しない（技術難度/運用/子どもの声を扱う問題の観点で見送り）

## 記憶（決定）

### 低センシティブ・ホワイトリスト

- 好きなこと
- 好きな食べ物
- 好きな遊び
- いまハマっていること

### 保存ルール（個人 / `PERSONAL`）

- `PERSONAL` 中に、ホワイトリストに該当する記憶候補が出たら、ぬいぐるみが「覚えていい？」と確認する
- 子どもが「いいえ」なら:
  - その候補は破棄（職員UIにも載せない）
- 子どもが「はい」なら:
  - `pending` としてDBに保存し、職員UIの確認キューに積む
  - ぬいぐるみの返答は「先生がいいよって言ったら覚えるね」のように“確定を約束しない”
- 職員が `Confirm` した時だけ `confirmed` になり、想起対象になる（最終確定は職員操作）

### 想起（思い出し）

- 原則 `PERSONAL(...)` の間だけ
- 低センシティブのみ
- `confirmed` のみ参照する

### `ROOM` の「みんなの思い出」

- 日付（`YYYY/MM/DD`）単位で保存する
- 内容は出来事・活動の要約のみ
- 個人名や個人が特定できる情報は入れない

## データ最小化（決定）

- 音声（録音ファイル）は保存しない
- STTの全文テキストは原則保存しない
- DBに保存するのは “記憶” として最小化した要約のみ（必要なら短い `source_quote` 程度）

## `pending` / `confirmed` / TTL（決定）

- `pending`:
  - 職員確認待ちの候補
  - `expires_at=24h`（期限切れは自動で忘却/削除）
- `confirmed`:
  - 職員が採用した記憶（想起対象）
  - デフォルトは自動忘却しない（`expires_at=NULL`）
  - 必要なら個別に `expires_at` を設定できる
- `rejected`:
  - 子どもが「いいえ」と言った／職員が Deny した候補（想起しない）

## UIの役割（決定）

- KIOSK（子ども用）:
  - マスコット表示 + 会話
  - Push-to-talk
  - （推奨）「はい/いいえ」を画面ボタンでも出せる（STT誤認対策）
- STAFF（職員用）:
  - `pending` 一覧 → Confirm/Deny
  - 緊急で `ROOMへ戻す`

