# Epic: [Epic名]

> このテンプレートは `/create-epic` コマンドで使用されます。
> PRDを参照し、実装計画を作成してください。

---

## メタ情報

- 作成日: YYYY-MM-DD
- 作成者: @username
- ステータス: Draft / Review / Approved
- 参照PRD: `docs/prd/[PRD名].md`

---

## 1. 概要

### 1.1 目的

<!-- PRDの目的・背景を要約 -->

[ここに記載]

### 1.2 スコープ

<!-- このEpicでカバーする範囲 -->

**含む:**
- [スコープ内1]
- [スコープ内2]

**含まない（PRDのスコープ外を継承）:**
- [スコープ外1]
- [スコープ外2]

### 1.3 PRD制約の確認

<!-- PRDのQ6とセクション7から引き継ぐ -->

項目: 規模感
PRDの値: [個人 / 小規模 / 中規模 / 大規模]
Epic対応: -

項目: 技術方針
PRDの値: [シンプル優先 / バランス / 拡張性優先]
Epic対応: 下記の制限を適用

項目: 既存言語/FW
PRDの値: [Yes / No / Unknown]
Epic対応: [具体名または-]

項目: デプロイ先
PRDの値: [Yes / No / Unknown]
Epic対応: [環境名または-]

---

## 2. 必須提出物（3一覧）

> **注意**: この3つの一覧は必須です。空欄にせず、該当なしの場合は「なし」と明記。

### 2.1 外部サービス一覧

外部サービス-1
名称: [例: PostgreSQL]
用途: [データ永続化]
必須理由: [RDB必須]
代替案: [SQLite（小規模なら）]

外部サービス-2
名称: [例: なし]
用途: -
必須理由: -
代替案: -

### 2.2 コンポーネント一覧

コンポーネント-1
名称: [例: API Server]
責務: [HTTPリクエスト処理]
デプロイ形態: [コンテナ]

コンポーネント-2
名称: [例: Web Frontend]
責務: [UI表示]
デプロイ形態: [静的ホスティング]

### 2.3 新規技術一覧

新規技術-1
名称: [例: Redis]
カテゴリ: [キャッシュ]
既存との差: [新規導入]
導入理由: [セッション管理]

新規技術-2
名称: [例: なし]
カテゴリ: -
既存との差: -
導入理由: -

---

## 3. 技術設計

### 3.1 アーキテクチャ概要

<!-- 図は使わず、テキストで構成と流れを列挙する -->

システム境界: [ここに記載]

主要データフロー-1
from: [送信元]
to: [送信先]
用途: [用途]
プロトコル: [HTTP / Job / Queue / ...]

### 3.2 技術選定

技術選定-1
カテゴリ: 言語
選択: [例: TypeScript]
理由: [理由]

技術選定-2
カテゴリ: フレームワーク
選択: [例: Next.js]
理由: [理由]

技術選定-3
カテゴリ: データベース
選択: [例: PostgreSQL]
理由: [理由]

技術選定-4
カテゴリ: インフラ
選択: [例: Vercel]
理由: [理由]

### 3.3 データモデル（概要）

<!-- 詳細は docs/data-model.md に記載 -->


エンティティ-1
名前: [例: User]
主要属性: [id, email, name]
関連: [has many Posts]

エンティティ-2
名前: [例: Post]
主要属性: [id, title, content]
関連: [belongs to User]

### 3.4 API設計（概要）

API-1
エンドポイント: [例: /api/users]
メソッド: [GET]
説明: [ユーザー一覧取得]

API-2
エンドポイント: [例: /api/users/:id]
メソッド: [GET]
説明: [ユーザー詳細取得]

### 3.5 プロジェクト固有指標（任意）

<!-- パフォーマンス、精度など、プロジェクト固有の成功指標がある場合に定義 -->

固有指標-1
指標名: [例: API応答時間]
測定方法: [例: k6でのベンチマーク]
目標値: [例: p95 < 200ms]
Before/After記録方法: [例: CI上で自動測定]

固有指標-2
指標名: [例: なし]
測定方法: -
目標値: -
Before/After記録方法: -

### 3.6 フォルダ構造設計（必須）

> **注意**: プロジェクトに最適化した構造を設計し、各ディレクトリの責務を明記すること。

トップレベル構造
- `[ディレクトリ名]`: [責務]
- `[ディレクトリ名]`: [責務]

設計理由
- [理由-1]
- [理由-2]

運用ルール
- [例: どの種類のコードをどこに配置するか]

### 3.7 AGENTS.md配置計画（必須）

> **注意**: `AGENTS.md` は百科事典ではなく見取り図（目次）として運用する。
> ルート + 必要なサブディレクトリに配置し、詳細ドキュメントへリンクすること。

AGENTS配置-1
配置先: `[例: AGENTS.md]`
対象範囲: [例: リポジトリ全体]
役割: [例: 目次/導線]
リンク先SoT: [例: docs/design/index.md]

AGENTS配置-2
配置先: `[例: apps/web/AGENTS.md]`
対象範囲: [例: フロントエンド]
役割: [例: UI実装時のガイド]
リンク先SoT: [例: docs/frontend/index.md]

### 3.8 静的解析ツールチェーン選定（必須）

> **注意**: lint/format/typecheck は必須。対象言語で「高速」「現行メンテ」「評判/採用実績」を満たすツールを選ぶ。

ツールチェーン-1
カテゴリ: lint
選択: [例: ruff / eslint]
選定理由: [速度・保守状況・採用実績]
ローカル実行方法: [例: pre-commit / npm scripts]
CI実行方法: [例: GitHub Actions job名]

ツールチェーン-2
カテゴリ: format
選択: [例: ruff format / prettier]
選定理由: [理由]
ローカル実行方法: [方法]
CI実行方法: [方法]

ツールチェーン-3
カテゴリ: typecheck
選択: [例: mypy / tsc]
選定理由: [理由]
ローカル実行方法: [方法]
CI実行方法: [方法]

代替案（よりシンプルな方法）
- [代替案]: [採用しなかった理由]

---

## 4. Issue分割案

### 4.1 Issue一覧

Issue-1
番号: 1
Issue名: [例: 環境構築]
概要: [プロジェクト初期化]
推定行数: [50-100行]
依存: [-]

Issue-2
番号: 2
Issue名: [例: DBスキーマ作成]
概要: [マイグレーション]
推定行数: [100-150行]
依存: [#1]

Issue-3
番号: 3
Issue名: [例: ユーザーAPI実装]
概要: [CRUD]
推定行数: [150-250行]
依存: [#2]

### 4.2 依存関係図

依存関係（関係を1行ずつ列挙）:
- Issue 2 depends_on Issue 1
- Issue 3 depends_on Issue 2

---

## 5. プロダクション品質設計（PRD Q6に応じて記載）

> **注意**: PRDのQ6回答に応じて、該当するセクションを記載してください。
> 詳細は各ルールファイルを参照。Noの場合は「N/A」と記載。

### 5.1 パフォーマンス設計（PRD Q6-7: Yesの場合必須）

<!-- Q6-7がNoの場合は「N/A（パフォーマンス要件なし）」と記載 -->
<!-- 詳細: .agent/rules/performance.md -->

PRD Q6-7: [Yes / No]

対象操作:
- [操作名]: [目標値]
- 例: 検索: 応答3秒以内

測定方法:
- ツール: [例: k6, Lighthouse]
- 環境: [例: ステージング環境]
- 条件: [例: 同時100ユーザー]

ボトルネック候補:
- [候補]: [理由]

対策方針:
- [対策]: [概要]

### 5.2 セキュリティ設計（PRD Q6-5: Yesの場合必須）

<!-- Q6-5がNoの場合は「N/A（個人情報/機密データなし）」と記載 -->
<!-- 詳細: .agent/rules/security.md -->

PRD Q6-5: [Yes / No]

扱うデータ:
- [データ種別]: [保護レベル]
- 例: パスワード: ハッシュ化（bcrypt）

認証/認可:
- 認証方式: [例: JWT, セッション]
- 認可モデル: [例: RBAC]

対策チェックリスト:
- [ ] 入力検証/サニタイズ
- [ ] SQLインジェクション対策
- [ ] XSS対策
- [ ] CSRF対策
- [ ] シークレット管理

### 5.3 観測性設計（PRD Q6-6: Yesの場合必須）

<!-- Q6-6がNoの場合は「N/A（監査ログ要件なし）」と記載 -->
<!-- 詳細: .agent/rules/observability.md -->

PRD Q6-6: [Yes / No]

ログ:
- 出力先: [例: stdout, CloudWatch]
- フォーマット: [例: JSON]
- 保持期間: [例: 30日]

メトリクス:
- [メトリクス名]: [説明]
- 例: request_duration_seconds: リクエスト処理時間

アラート:
- [条件]: [通知先]
- 例: エラー率5%超過: Slack通知

### 5.4 可用性設計（PRD Q6-8: Yesの場合必須）

<!-- Q6-8がNoの場合は「N/A（可用性要件なし）」と記載 -->
<!-- 詳細: .agent/rules/availability.md -->

PRD Q6-8: [Yes / No]

SLO:
- 稼働率: [例: 99.9%]
- 許容ダウンタイム: [例: 月間43分]

障害復旧:
- RTO: [例: 1時間]
- RPO: [例: 1時間]
- バックアップ頻度: [例: 日次]

ロールバック:
- 方式: [例: Blue-Green]
- 所要時間: [例: 5分以内]

---

## 6. リスクと対策

リスク-1
リスク: [例: 外部API障害]
影響度: [高]
対策: [リトライ + フォールバック]

リスク-2
リスク: [例: パフォーマンス不足]
影響度: [中]
対策: [インデックス追加]

---

## 7. マイルストーン

Phase-1
フェーズ: Phase 1
完了条件: [環境構築完了]
目標日: [YYYY-MM-DD]

Phase-2
フェーズ: Phase 2
完了条件: [コア機能実装]
目標日: [YYYY-MM-DD]

Phase-3
フェーズ: Phase 3
完了条件: [テスト・リリース]
目標日: [YYYY-MM-DD]

---

## 8. 技術方針別の制限チェック

<!-- PRDの技術方針に応じてチェック -->

### シンプル優先の場合

- [ ] 外部サービス数が1以下
- [ ] 新規導入ライブラリが3以下
- [ ] 新規コンポーネント数が3以下
- [ ] 非同期基盤（キュー/イベントストリーム）を使用していない
- [ ] マイクロサービス分割をしていない
- [ ] コンテナオーケストレーション（K8s等）を使用していない

### バランスの場合

- [ ] 外部サービス数が3以下
- [ ] 新規導入ライブラリが5以下
- [ ] 新規コンポーネント数が5以下
- [ ] 非同期基盤を使用する場合は明示的理由あり
- [ ] マイクロサービス分割する場合は明示的理由あり

### 共通チェック

- [ ] 新規技術/サービス名が5つ以下
- [ ] 各選択に「なぜこれを選んだか」の理由がある
- [ ] 代替案（よりシンプルな方法）が提示されている
- [ ] 「将来のため」だけを理由にした項目がない
- [ ] 必須提出物（外部サービス一覧/コンポーネント一覧/新規技術一覧）が揃っている
- [ ] プロジェクトに最適化したフォルダ構造が定義されている
- [ ] ルート/サブディレクトリのAGENTS.md配置計画が定義されている
- [ ] lint/format/typecheckの高速ツールチェーンが選定され、ローカル/CI統合方法が記載されている

---

## 9. Unknown項目の確認（PRDから引き継ぎ）

<!-- PRDのQ6でUnknownだった項目をここで解消 -->


Unknown-1
項目: [例: 期限]
PRDの値: [Unknown]
確認結果: [確認した結果: 2024-03-31]

---

## 変更履歴

- YYYY-MM-DD: v1.0 初版作成（@username）
